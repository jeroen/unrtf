INSTDIR=../inst
PKG_CPPFLAGS = -Ilibunrtf -DHAVE_CONFIG_H -DPKGDATADIR=\"../share\"

LIBUNRTF = \
	libunrtf/attr.o libunrtf/convert.o libunrtf/error.o libunrtf/hash.o libunrtf/main.o \
	libunrtf/malloc.o	libunrtf/my_iconv.o libunrtf/output.o libunrtf/parse.o libunrtf/path.o \
	libunrtf/unicode.o libunrtf/user.o libunrtf/util.o libunrtf/word.o

# Link iconv only on OSX
LIBICONVHACK = $(subst -framework,-liconv -framework,$(FOUNDATION_LIBS))
WINICONVHACK = $(subst 64,$(LIBR) -lRiconv -lws2_32,$(subst 32,64,$(WIN)))

all: clean unrtf

unrtf: $(LIBUNRTF) 
	$(CC) $(CFLAGS) -o unrtf$(WIN) $(LIBUNRTF) $(LIBICONVHACK) $(WINICONVHACK) 
	mkdir -p $(INSTDIR)/bin
	cp -f unrtf$(WIN) $(INSTDIR)/bin/
	cp -Rf share $(INSTDIR)/

clean:
	rm -f $(LIBUNRTF) unrtf
